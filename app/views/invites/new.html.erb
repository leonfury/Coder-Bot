<style>
    body {
    margin: 0;
    padding: 0;
    }

    #map {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100%;
    }
</style>

<div id='map'></div>


<div id="sidebar_meeting" class="d-none">
    <div id="event_list" class="m-3 text-white">
        <%= render partial: "invites/list" %>
    </div>

    <div id="event_details" class="m-3 text-white d-none">
        <%= render partial: "invites/detail" %>
    </div>
</div>

<div id="next_academy" class="d-none">
    <img src="https://www.nextacademy.com/img/nextacademy-white-logo.png" class="pb-5" style="height: 200px; position: absolute; top: 80px; left: 10px; z-index: 50;">
    <div class="n_main-elements">
        <div class="n_homepage-header">


  
            <h1 class="text-white text-bolder d-block" style="font-size: 60px;">
                1,200 People from 57 Countries
                <br/>Learned to Code & Sell Online With Us
            </h1>
            
            <p class="next_academy_text text-white d-none d-md-block">Join our community of graduates who run multi-million dollar businesses, impact communities through social projects,<br /> and work at great companies like Google, Uber, AirAsia, Fave, Mindvalley</p>
            
            <p class="next_academy_text text-white d-block d-md-none">Join our graduate community who run multi-million dollar businesses, impact communities through social projects, and work at great companies like Google, Uber, AirAsia, Fave, Mindvalley</p>
            <a href="https://www.nextacademy.com/" class="btn btn-success"><h1> APPLY NOW </h1> </a>
        </div>
      </div>
  
    <div class="n_video-container">
        <video id="n_background-video" class="header-video" autoplay loop muted poster="https://www.nextacademy.com/img/video-placeholder-bg.jpg">
            <source src="https://s3-ap-southeast-1.amazonaws.com/next-academy-site-videos/video-1511348280.mp4">
        </video>
    </div>

    <div id="youtube-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-youtube">
            <div class="modal-content embed-responsive embed-responsive-16by9">
                <iframe id="yt-player" class="embed-responsive-item" data-youtube="https://www.youtube.com/embed/3qVb09Y0CZo"
                frameborder="0" allowfullscreen></iframe>
            </div>
        </div>
    </div>
</div>
<script>
$('.event_list_items').on('click', () => {
    $('#event_list').addClass('d-none');
    $('#event_details').removeClass('d-none');
});

mapboxgl.accessToken = 'pk.eyJ1IjoibGltankwMTE0IiwiYSI6ImNqcmZyeGVveTFmenM0OWxwb2pheGZ3MW8ifQ.ka2dxppOoMDqiLiqzhh96Q';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v10', 
    <% if @invites.count != 0 %>
        center: [101.6958, 3.1466],
        zoom: 12,
    <% else %>
        // style: 'mapbox://styles/mapbox/satellite-v9', 
        center: [101.6958, 3.1466],
        zoom: 1,
    <% end %>

});

// load all hotel data into map
map.on("load", () => {
    $.ajax({
        url: "/meeting_map",
        method: "POST",
        dataType: "JSON",
        success: function(response){
            map.addSource('Hotel', {
                type: 'geojson',
                data: response[0]
            });

            //add layer of map
            map.addLayer({
                'id': 'Hotel',
                'type': 'circle',
                'source': 'Hotel',
                'layout': {
                    'visibility': 'none'
                },
                'paint': {
                    'circle-radius': 18,
                    'circle-color': 'rgba(255,0,0,0)'
                }
            })

            //add marker for hotel
            map.getSource('Hotel')._data.features.forEach(function(marker) {
                var el = document.createElement('div');
                el.className = 'marker d-none';
                el.style.backgroundImage = 'url(https://next-academy-group-1-coder-bot.herokuapp.com/assets/hotel_icon-fa5aa9fe3ae2a15f6465af79aa852e5db02d6aed3a2cbdc46bfeaee4dcf775a4.gif)';
                el.style.height = "50px";
                el.style.width = "50px";

                new mapboxgl.Marker(el).setLngLat(marker.center).addTo(map);
            });
            $('#sidebar_meeting').removeClass('d-none'); //meeting's sidebar
            
        },
        error: function(error){
            console.log(error);
        }
    });
    
    map.on('mouseenter', 'Hotel', function (e) {
        map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'Hotel', function () {
        map.getCanvas().style.cursor = '';
    });
});


</script>
